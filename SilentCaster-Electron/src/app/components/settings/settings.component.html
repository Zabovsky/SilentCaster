<div class="settings-container">
  <div class="settings-header">
    <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
  <div class="user-info-section" *ngIf="isAuthenticated && userInfo">
    <div class="user-card">
      <img [src]="userInfo.profile_image_url || 'https://static-cdn.jtvnw.net/user-default-pictures-uv/294c98b5-e34d-42cd-a8f0-14046872a620-profile_image-70x70.png'" 
           [alt]="userInfo.display_name" 
           class="user-avatar" />
      <div class="user-details">
        <div class="user-name">{{ userInfo.display_name }}</div>
        <div class="user-login">{{ '@' + userInfo.login }}</div>
      </div>
      <button class="btn btn-secondary btn-small" (click)="logout()">–í—ã–π—Ç–∏</button>
    </div>
  </div>

  <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
  <div class="auth-section" *ngIf="!isAuthenticated">
    <div class="section-header">
      <h3>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Twitch</h3>
      <button class="btn-toggle" (click)="showAuthSection = !showAuthSection">
        {{ showAuthSection ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–∫–∞–∑–∞—Ç—å' }}
      </button>
    </div>
    <app-twitch-auth 
      *ngIf="showAuthSection"
      (authSuccess)="onAuthSuccess()"
    ></app-twitch-auth>
  </div>

  <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞ -->
  <div class="settings-section">
    <h3>üí¨ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</h3>
    <div class="settings-group">
      <label class="setting-item">
        <span class="setting-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π:</span>
        <input 
          type="number" 
          [(ngModel)]="settings.maxChatMessages" 
          min="50" 
          max="1000" 
          step="50"
          class="setting-input"
        />
        <span class="setting-hint">–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: {{ settings.maxChatMessages || 100 }}</span>
      </label>
    </div>
  </div>

  <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏ -->
  <div class="settings-section">
    <h3>üîä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏</h3>
    <div class="settings-group">
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.enableChatVoice" />
        <span>–í–∫–ª—é—á–∏—Ç—å –æ–∑–≤—É—á–∫—É —á–∞—Ç–∞</span>
      </label>
      <label class="setting-item" *ngIf="settings.enableChatVoice">
        <span class="setting-label">–°–∏–º–≤–æ–ª —Ç—Ä–∏–≥–≥–µ—Ä–∞:</span>
        <input 
          type="text" 
          [(ngModel)]="settings.chatTriggerSymbol" 
          placeholder="!!!"
          class="setting-input"
        />
        <span class="setting-hint">–û–∑–≤—É—á–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —ç—Ç–∏–º —Å–∏–º–≤–æ–ª–æ–º</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.voiceOnlyForSubscribers" />
        <span>–¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.voiceOnlyForVips" />
        <span>–¢–æ–ª—å–∫–æ –¥–ª—è VIP</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.voiceOnlyForModerators" />
        <span>–¢–æ–ª—å–∫–æ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.voiceOnlyForFollowers" />
        <span>–¢–æ–ª—å–∫–æ –¥–ª—è —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤</span>
      </label>
    </div>
  </div>

  <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ -->
  <div class="settings-section">
    <h3>üõ°Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
    <div class="settings-group">
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.moderationSettings.forbiddenWordsEnabled" />
        <span>–í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.moderationSettings.caseSensitive" />
        <span>–£—á–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.moderationSettings.spamDetectionEnabled" />
        <span>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–ø–∞–º–∞</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.moderationSettings.capsDetectionEnabled" />
        <span>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–∞–ø—Å–∞</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.moderationSettings.messageLengthCheckEnabled" />
        <span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è</span>
      </label>
      <label class="setting-item" *ngIf="settings.moderationSettings.messageLengthCheckEnabled">
        <span class="setting-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:</span>
        <input 
          type="number" 
          [(ngModel)]="settings.moderationSettings.maxMessageLength" 
          min="50" 
          max="500"
          class="setting-input"
        />
      </label>
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="settings.moderationSettings.autoDeleteHighSeverity" />
        <span>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤—ã—Å–æ–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –Ω–∞—Ä—É—à–µ–Ω–∏—è</span>
      </label>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
  <div class="settings-actions">
    <button class="btn btn-primary" (click)="saveSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
  </div>
</div>

